// Evaluation Metrics - End-to-End Integration Tests// Run with: npx tsx lib/tools/evaluation-metrics/__tests__/e2e.integration.test.tsimport { evaluationMetricsTool } from '../index';console.log('========================================');console.log('Evaluation Metrics - E2E Integration Tests');console.log('========================================\n');const testUserId = 'test-user-123';const testParams = {  userId: testUserId,  period: 'month' as const,  startDate: '2025-01-01',  endDate: '2025-01-31'};// Test 1: Tool definition existsconsole.log('Test 1: Tool definition');console.log('----------------------------------------');if (!evaluationMetricsTool) {  throw new Error('evaluationMetricsTool is not defined!');}console.log('Tool name:', evaluationMetricsTool.name);console.log('Tool version:', evaluationMetricsTool.version);console.log('Tool description length:', evaluationMetricsTool.description.length);console.log('✓ Test 1 passed - Tool definition exists\n');// Test 2: Verify all operations are listedconsole.log('Test 2: Operation enumeration');console.log('----------------------------------------');const expectedOperations = [  'get_metrics',  'quality_trends',  'success_analysis',  'compare_periods',  'model_comparison',  'tool_impact_analysis',  'error_analysis',  'temporal_analysis',  'textual_feedback_analysis',  'benchmark_analysis',  'advanced_sentiment_analysis',  'predictive_quality_modeling',  'anomaly_detection'];const enumOperations = evaluationMetricsTool.parameters.properties.operation.enum;console.log('Expected operations:', expectedOperations.length);console.log('Actual operations:', enumOperations.length);expectedOperations.forEach(op => {  if (!enumOperations.includes(op)) {    throw new Error(`Missing operation in enum: ${op}`);  }});console.log('✓ Test 2 passed - All 13 operations present\n');// Test 3: Execute advanced_sentiment_analysisconsole.log('Test 3: Execute advanced_sentiment_analysis');console.log('----------------------------------------');evaluationMetricsTool.execute({  operation: 'advanced_sentiment_analysis',  ...testParams})  .then((result) => {    if (!result.success) throw new Error('Operation failed');    if (!result.data) throw new Error('No data returned');        console.log('Response:');    console.log('  success:', result.success);    console.log('  totalAnalyzed:', result.data.totalAnalyzed);    console.log('  averageConfidence:', result.data.averageConfidence);    console.log('✓ Test 3 passed\n');        // Test 4: Execute predictive_quality_modeling    console.log('Test 4: Execute predictive_quality_modeling');    console.log('----------------------------------------');    return evaluationMetricsTool.execute({      operation: 'predictive_quality_modeling',      ...testParams    });  })  .then((result) => {    if (!result.success) throw new Error('Operation failed');    if (!result.data) throw new Error('No data returned');        console.log('Response:');    console.log('  success:', result.success);    console.log('  dataPointsAnalyzed:', result.data.dataPointsAnalyzed);    console.log('  currentQuality:', result.data.currentQuality);    console.log('  modelAccuracy:', result.data.modelAccuracy);    console.log('✓ Test 4 passed\n');        // Test 5: Execute anomaly_detection    console.log('Test 5: Execute anomaly_detection');    console.log('----------------------------------------');    return evaluationMetricsTool.execute({      operation: 'anomaly_detection',      ...testParams    });  })  .then((result) => {    if (!result.success) throw new Error('Operation failed');    if (!result.data) throw new Error('No data returned');        console.log('Response:');    console.log('  success:', result.success);    console.log('  totalEvaluations:', result.data.totalEvaluations);    console.log('  anomaliesDetected:', result.data.anomaliesDetected);    console.log('✓ Test 5 passed\n');        // Test 6: Test error handling with invalid operation    console.log('Test 6: Error handling - invalid operation');    console.log('----------------------------------------');    return evaluationMetricsTool.execute({      operation: 'invalid_operation_name',      ...testParams    });  })  .then(() => {    throw new Error('Should have thrown error for invalid operation');  })  .catch((error) => {    if (error.message.includes('Unknown operation')) {      console.log('✓ Test 6 passed - Correctly handles invalid operation\n');            // Test 7: Test error handling with missing userId      console.log('Test 7: Error handling - missing userId');      console.log('----------------------------------------');      return evaluationMetricsTool.execute({        operation: 'get_metrics',        period: 'month'      });    } else {      throw error;    }  })  .then(() => {    throw new Error('Should have thrown error for missing userId');  })  .catch((error) => {    if (error.message.includes('User ID required')) {      console.log('✓ Test 7 passed - Correctly handles missing userId\n');            // Test 8: Test all Phase 3 operations in sequence      console.log('Test 8: Sequential execution of all Phase 3 operations');      console.log('----------------------------------------');      return Promise.all([        evaluationMetricsTool.execute({          operation: 'advanced_sentiment_analysis',          ...testParams        }),        evaluationMetricsTool.execute({          operation: 'predictive_quality_modeling',          ...testParams        }),        evaluationMetricsTool.execute({          operation: 'anomaly_detection',          ...testParams        })      ]);    } else {      throw error;    }  })  .then((results) => {    console.log('All 3 Phase 3 operations completed:');    results.forEach((result, index) => {      if (!result.success) throw new Error(`Operation ${index} failed`);      console.log(`  Operation ${index + 1}: success`);    });    console.log('✓ Test 8 passed - Parallel execution successful\n');        console.log('========================================');    console.log('All E2E Integration Tests Passed! ✓');    console.log('========================================');    console.log('\nTest Summary:');    console.log('  Tool definition: ✓');    console.log('  Operation enumeration: ✓');    console.log('  Sentiment analysis: ✓');    console.log('  Predictive modeling: ✓');    console.log('  Anomaly detection: ✓');    console.log('  Error handling (invalid op): ✓');    console.log('  Error handling (missing userId): ✓');    console.log('  Parallel execution: ✓');    console.log('\n✓ All 8 tests passed successfully!\n');  })  .catch((error) => {    console.error('\n✗ Test failed:', error.message);    console.error('Stack:', error.stack);    process.exit(1);  });